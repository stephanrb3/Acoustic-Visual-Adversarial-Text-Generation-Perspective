import random
from string import ascii_letters
import homoglyphs as hg

#### Phoneme Dictionary ############
Homoglyphs =	{
'a' : ['@', '4', 'Ã€', 'Ã', 'Ã‚' ,'Ãƒ', 'Ã„', 'Ã…', 'Ã ', 'Ã¡', 'Ã¢', 'Ã£', 'Ã¤', 'Ã¥', 'É‘', 'Î‘', 'Î±', 'Ğ°', 'áª', 'ï¼¡', 'ï½'],
'A' : ['@', '4', 'Ã€', 'Ã', 'Ã‚' ,'Ãƒ', 'Ã„', 'Ã…', 'Ã ', 'Ã¡', 'Ã¢', 'Ã£', 'Ã¤', 'Ã¥', 'É‘', 'Î‘', 'Î±', 'Ğ°', 'áª', 'ï¼¡', 'ï½'],
'b':['B','b','ÃŸ','Ê™','Î’','Î²','Ğ’','Ğ¬','á´','á›’','ï¼¢','ï½‚'], 
'B':['B','b','ÃŸ','Ê™','Î’','Î²','Ğ’','Ğ¬','á´','á›’','ï¼¢','ï½‚'], 
'c':['C','c','Ï²','Ï¹','Ğ¡','Ñ','áŸ','â…­','â…½','ğ ','ï¼£','ï½ƒ'],
'C':['C','c','Ï²','Ï¹','Ğ¡','Ñ','áŸ','â…­','â…½','ğ ','ï¼£','ï½ƒ'],
'd':['D','d','Ä','Ä','Ä','Ä‘','Ô','Õª','á ','á¸','â…®','â…¾','ï¼¤','ï½„'],
'D':['D','d','Ä','Ä','Ä','Ä‘','Ô','Õª','á ','á¸','â…®','â…¾','ï¼¤','ï½„'],
'e':['E','e','Ãˆ','Ã‰','ÃŠ','Ã‹','Ã©','Ãª','Ã«','Ä’','Ä“','Ä”','Ä•','Ä–','Ä—','Ä˜','Äš','Ä›','Î•','Ğ•','Ğµ','á¬','ï¼¥','ï½…'],
'E':['E','e','Ãˆ','Ã‰','ÃŠ','Ã‹','Ã©','Ãª','Ã«','Ä’','Ä“','Ä”','Ä•','Ä–','Ä—','Ä˜','Äš','Ä›','Î•','Ğ•','Ğµ','á¬','ï¼¥','ï½…'],
'f':['F','f','Ïœ','ï¼¦','ï½†'],
'F':['F','f','Ïœ','ï¼¦','ï½†'],
'g':['G','g','É¡','É¢','ÔŒ','Õ¶','á€','ï¼§','ï½‡'],
'G':['G','g','É¡','É¢','ÔŒ','Õ¶','á€','ï¼§','ï½‡'],
'h':['H' 'h' 'Êœ' 'Î—' 'Ğ' 'Ò»' 'á»' 'ï¼¨' 'ï½ˆ'],
'H':['H' 'h' 'Êœ' 'Î—' 'Ğ' 'Ò»' 'á»' 'ï¼¨' 'ï½ˆ'],
'i':['I','i','l','É©','Î™','Ğ†','Ñ–','Ø§','á¥','á›','â… ','â…°','ï½‰'],
'I':['I','i','l','É©','Î™','Ğ†','Ñ–','Ø§','á¥','á›','â… ','â…°','ï½‰'],
'j':['J','j','Ï³','Ğˆ','Ñ˜','Õµ','á«','ï¼ª','ï½Š'],
'J':['J','j','Ï³','Ğˆ','Ñ˜','Õµ','á«','ï¼ª','ï½Š'],
'k':['K','k','Îš','Îº','Ğš','á¦','á›•','â„ª','ï¼«','ï½‹'],
'K':['K','k','Îš','Îº','Ğš','á¦','á›•','â„ª','ï¼«','ï½‹'],
'l':['L','l','ÊŸ','Î¹','Ø§','á','â…¬','â…¼','ï¼¬','ï½Œ'],
'L':['L','l','ÊŸ','Î¹','Ø§','á','â…¬','â…¼','ï¼¬','ï½Œ'],
'm':['M','m','Îœ','Ïº','Ğœ','á·','á›–','â…¯','â…¿','ï¼­','ï½'],
'M':['M','m','Îœ','Ïº','Ğœ','á·','á›–','â…¯','â…¿','ï¼­','ï½'],
'n':['N','n','É´','Î','ï¼®','ï½'],
'N':['N','n','É´','Î','ï¼®','ï½'],
'o':['Ó¨','Ïƒ','Ã°','Ã˜','o','Ö…','O','á“','oÌ´','oÌ·','oÌ³','oÌ¾','oÍ','oÌ½Í“','á»–','â“','Ïƒ','ğ“¸','ğ“','ğ•†','ğ'], 
'O':['Ó¨','Ïƒ','Ã°','Ã˜','o','Ö…','O','á“','oÌ´','oÌ·','oÌ³','oÌ¾','oÍ','oÌ½Í“','á»–','â“','Ïƒ','ğ“¸','ğ“','ğ•†','ğ'], 
'p':['p','P','ğ”­','ğ“¹','ğ“…','ğ•¡','ï½','ğŸ„¿','á®','â„˜','p','ğ©','ğ˜±','ğ™¥','ğš™','P','Ï','Ã¾','â‚±','å©','ï½±','Ö„','á‘­','á•µ','pÌ´','pÌ·', 'pÌ²','pÌ³','pÌ¾','â“…','Æ¤','ğ','ğ“¹'],  
'P':['p','P','ğ”­','ğ“¹','ğ“…','ğ•¡','ï½','ğŸ„¿','á®','â„˜','p','ğ©','ğ˜±','ğ™¥','ğš™','P','Ï','Ã¾','â‚±','å©','ï½±','Ö„','á‘­','á•µ','pÌ´','pÌ·' ,'pÌ²','pÌ³','pÌ¾','â“…','Æ¤','ğ','ğ“¹'],  
'q':['q','Q','ğ”®','ğ“†','ğ•¢','ï½‘','Q','ğŸ…€','â“ ','á»£','Ï™','Õ¦','á¤','ğšš','ÉŠ','qÌ´' ,'qÌ³','qÌ¾','â„š','Î©','ï¼±'],   
'Q':['q','Q','ğ”®','ğ“†','ğ•¢','ï½‘','Q','ğŸ…€','â“ ','á»£','Ï™','Õ¦','á¤','ğšš','ÉŠ','qÌ´' ,'qÌ²','qÌ³','qÌ¾','â„š','Î©','ï¼±'],  
'r':['r','R','r','Ê€','Ô»','á’','áš±','ï¼²','ï½’'],
'R':['r','R','r','Ê€','Ô»','á’','áš±','ï¼²','ï½’'],
's':['s','S','ğ”°','ğ“ˆ','ğ•¤','ğŸ…‚','ê™…','â“¢','à¸£','Ê‚','Ö†','á•','Å','Â§','â‚´','sÌ´','sÌ·','sÌ³','sÌ¾'],
'S':['s','S','ğ”°','ğ“ˆ','ğ•¤','ğŸ…‚','ê™…','â“¢','à¸£','Ê‚','Ö†','á•','Å','Â§','â‚´','sÌ´','sÌ·','sÌ³','sÌ¾'],
't':['t','T','ğ”±','ğ“‰','ğ•¥','Ê‡','ğŸ…ƒ','Æš','â“£','È¶','Æ¬','â€ ','â‚®','ã„’','ï½²','Õ§','tÌ´','tÌ·','tÍ','Å¦','ğ“£'], 
'T':['t','T','ğ”±','ğ“‰','ğ•¥','Ê‡','ğŸ…ƒ','Æš','â“£','È¶','Æ¬','â€ ','â‚®','ã„’','ï½²','Õ§','tÌ´','tÌ·','tÍ','Å¦','ğ“£'], 
'u':['u','U','ğ”²','ğ“Š','ğ•¦','ğŸ…„','â“¤','à¸¢','Ï…','ÊŠ','á¬','Å³','à¸™','Ğ¦','Âµ','É„','ã„©','ã²','Õ´','á‘˜','uÌ·' ,'uÌ¾','uÍ','Ã¹','ğ•Œ','á»®'],
'U':['u','U','ğ”²','ğ“Š','ğ•¦','ğŸ…„','â“¤','à¸¢','Ï…','ÊŠ','á¬','Å³','à¸™','Ğ¦','Âµ','É„','ã„©','ã²','Õ´','á‘˜','uÌ·' ,'uÌ¾','uÍ','Ã¹','ğ•Œ','á»®'],
'v':['v','V','ğ”³','ğ“‹','ğ•§','ÊŒ','ğŸ……','â“¥','×©','Ê‹','á‰','à¸‡','âˆš','áº','vÌ´','vÌ·','vÍ','vÌ½Í“','Ñ¶'],
'V':['v','V','ğ”³','ğ“‹','ğ•§','ÊŒ','ğŸ……','â“¥','×©','Ê‹','á‰','à¸‡','âˆš','áº','vÌ´','vÌ·','vÍ','vÌ½Í“','Ñ¶'],
'w':['w','W','ğ”´','à¸¬','ğ“Œ','ğ•¨','Ê','ğŸ…†','â“¦','É¯','á‡','á¿³','àºŸ','Ğ©','â‚©','å±±'],
'W':['w','W','ğ”´','à¸¬','ğ“Œ','ğ•¨','Ê','ğŸ…†','â“¦','É¯','á‡','á¿³','àºŸ','Ğ©','â‚©','å±±'],
'x':['x','X','ğ”µ','ğ“','ğ•©','ğŸ…‡','×','Ó¼','áŒ€','Ò³','Ó¾','ä¹‚','ï¾’','xÌ´','xÌ¾','xÍ','Ğ–','â“§'], 
'X':['x','X','ğ”µ','ğ“','ğ•©','ğŸ…‡','×','Ó¼','áŒ€','Ò³','Ó¾','ä¹‚','ï¾’','xÌ´','xÌ¾','xÍ','Ğ–','â“§'],
'y':['y','Y','ğ”¶','Ğ','ğ“','ğ•ª','Ê','Ê','ğŸ…ˆ','â“¨','×¥','áƒ§','à¸¯','Â¥','ã„š','ï¾˜','Õ¾','á–»','yÌ·' ,'yÌ¾'],
'Y':['y','Y','ğ”¶','Ğ','ğ“','ğ•ª','Ê','Ê','ğŸ…ˆ','â“¨','×¥','áƒ§','à¸¯','Â¥','ã„š','ï¾˜','Õ¾','á–»','yÌ·' ,'yÌ¾'],
'z':['z','Z','ğ”·','â„¤','ğ“','ğ•«','ğŸ…‰','Æ¹','â“©','Õ¹','È¥','áš','Ê‘','àºŠ','ä¹™','Õ€','zÌ´','Å¾'],
'Z':['z','Z','ğ”·','â„¤','ğ“','ğ•«','ğŸ…‰','Æ¹','â“©','Õ¹','È¥','áš','Ê‘','àºŠ','ä¹™','Õ€','zÌ´','Å¾']
}


def VisualAttack(word, edit_distance):
    """
    This function takes in a word and replaces random characters with visually similar homoglyphs

    @param word: word to be attacked
    @param edit distance: amount of characters to change.
    """
    # If you just want to change chars that are not whitespace and not the same char in regards to index,
    #  you can first pull the indexes where the non-whitespace chars are:
    inds = [i for i,_ in enumerate(word)]
    # print(word)
    if (edit_distance<len(word)):
        sam = random.sample(inds, edit_distance)
        #Then use those indexes to replace.
        lst = list(word)
        for ind in sam:
            text = lst[ind] 
            if text in Homoglyphs:
                #### Homemade dictionary implementation
                homoglyph = Homoglyphs[text]   
                #replace letter
                lst[ind] = random.choice(homoglyph)
            else: 
                # get homoglyphs (latin alphabet initialized by default) 
                homo = hg.Homoglyphs().get_combinations(text)   #ex: ['q', 'ğª', 'ğ‘', 'ğ’’', 'ğ“†', 'ğ“º', 'ğ”®', 'ğ•¢', 'ğ––',
                # print(homo)

                #replace letter
                lst[ind] = random.choice(homo)
    else:
        lst = list(word)
        for ind in lst:
            if ind in Homoglyphs:
                #### Homemade dictionary implementation
                homoglyph = Homoglyphs[ind]   
                #replace letter
                ind = random.choice(homoglyph)
            else: 
                # get homoglyphs (latin alphabet initialized by default) 
                homo = hg.Homoglyphs().get_combinations(ind)   #ex: ['q', 'ğª', 'ğ‘', 'ğ’’', 'ğ“†', 'ğ“º', 'ğ”®', 'ğ•¢', 'ğ––',
                # print(homo)

                #replace letter
                ind = random.choice(homo)
    return "".join(lst)

def Find_Homoglyphs(word, factor, edit_distance):
    """
    This function takes in a word and replaces random characters with visually similar homoglyphs, 
    and returns a list of those word replacements.

    @param word: word to be attacked
    @param edit distance: amount of characters to change.
    @param factor: Integer. How many different words to substitute per index.
    """
    for x in range(factor):
        words = VisualAttack(word, edit_distance)
        # print(words)

    return words

if __name__ == '__main__':
    # VisualAttack("adriano")
    Find_Homoglyphs("hate", 5, 2)